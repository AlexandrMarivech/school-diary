{% extends "base.html" %}
{% block content %}

<div class="row justify-content-center">
  <div class="col-lg-10">
    <div class="card shadow-sm border-0 rounded-3 mb-4">
      <div class="card-body">
        <h3 class="card-title text-center mb-4">üìä –û—Ç—á—ë—Ç –ø–æ –∫–ª–∞—Å—Å—É</h3>

        <!-- üîπ –§–æ—Ä–º–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ (—É—á–∏—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –≥–æ–¥, –ø—Ä–µ–¥–º–µ—Ç –∏ –ø–µ—Ä–∏–æ–¥) -->
        <form method="get" class="row g-3 mb-4">
          <!-- –ü–æ–ª–µ –≤—ã–±–æ—Ä–∞ –≥–æ–¥–∞ -->
          <div class="col-md-2">
            <label class="form-label">–ì–æ–¥</label>
            <input type="number" name="year" value="{{ year }}" class="form-control form-control-sm">
          </div>
          <!-- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ —Å –≤—ã–±–æ—Ä–æ–º –ø—Ä–µ–¥–º–µ—Ç–∞ -->
          <div class="col-md-4">
            <label class="form-label">–ü—Ä–µ–¥–º–µ—Ç</label>
            <select name="subject" class="form-select form-select-sm">
              <option value="0">–í—Å–µ</option>
              {% for subj in subjects %}
                <option value="{{ subj.id }}" {% if subj.id == subject_id %}selected{% endif %}>
                  {{ subj.name }}
                </option>
              {% endfor %}
            </select>
          </div>
          <!-- –í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞: –≥–æ–¥, –ø–æ–ª—É–≥–æ–¥–∏–µ –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —á–µ—Ç–≤–µ—Ä—Ç—å -->
          <div class="col-md-4">
            <label class="form-label">–ü–µ—Ä–∏–æ–¥</label>
            <select name="period" class="form-select form-select-sm">
              <option value="year" {% if period == 'year' %}selected{% endif %}>–ì–æ–¥</option>
              <option value="halfyear1" {% if period == 'halfyear1' %}selected{% endif %}>1 –ø–æ–ª—É–≥–æ–¥–∏–µ</option>
              <option value="halfyear2" {% if period == 'halfyear2' %}selected{% endif %}>2 –ø–æ–ª—É–≥–æ–¥–∏–µ</option>
              <option value="quarter1" {% if period == 'quarter1' %}selected{% endif %}>1 —á–µ—Ç–≤–µ—Ä—Ç—å</option>
              <option value="quarter2" {% if period == 'quarter2' %}selected{% endif %}>2 —á–µ—Ç–≤–µ—Ä—Ç—å</option>
              <option value="quarter3" {% if period == 'quarter3' %}selected{% endif %}>3 —á–µ—Ç–≤–µ—Ä—Ç—å</option>
              <option value="quarter4" {% if period == 'quarter4' %}selected{% endif %}>4 —á–µ—Ç–≤–µ—Ä—Ç—å</option>
            </select>
          </div>
          <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ -->
          <div class="col-md-2 d-grid">
            <label class="form-label">&nbsp;</label>
            <button type="submit" class="btn btn-primary btn-sm">üîé –ü–æ–∫–∞–∑–∞—Ç—å</button>
          </div>
        </form>

        <!-- üîπ –¢–∞–±–ª–∏—Ü–∞ –æ—Ç—á—ë—Ç–∞ -->
        <div class="table-responsive">
          <table class="table table-hover table-bordered align-middle text-center">
            <thead class="table-light">
              <tr>
                <th>–§–ò–û —É—á–µ–Ω–∏–∫–∞</th>
                <th>–û—Ü–µ–Ω–∫–∏</th>
                <th>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</th>
              </tr>
            </thead>
            <tbody>
              {% for name, grades, avg in report_data %}
              <tr>
                <!-- –ò–º—è —É—á–µ–Ω–∏–∫–∞ -->
                <td class="text-start">{{ name }}</td>
                <!-- –°–ø–∏—Å–æ–∫ –æ—Ü–µ–Ω–æ–∫ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é -->
                <td>
                  {% if grades %}
                    {{ grades|join(", ") }}
                  {% else %}
                    <span class="text-muted">‚Äî</span>
                  {% endif %}
                </td>
                <!-- –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª -->
                <td>
                  {% if avg %}
                    <span class="badge bg-success">{{ avg }}</span>
                  {% else %}
                    <span class="text-muted">-</span>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <!-- üîπ –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
        <div class="d-flex justify-content-between mt-3">
          <!-- –ù–∞–∑–∞–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–≤–æ–¥–∞ –æ—Ü–µ–Ω–æ–∫ -->
          <a href="{{ url_for('teacher_page') }}" class="btn btn-outline-secondary">‚Üê –ù–∞–∑–∞–¥</a>
          <!-- –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–∞ –∑–∞ –≥–æ–¥ –≤ Excel -->
          <a href="{{ url_for('export_class', subject=subject_id, year=year, quarter=0) }}" class="btn btn-outline-success">
            ‚¨á –°–∫–∞—á–∞—Ç—å –û—Ç—á–µ—Ç (–≥–æ–¥)
          </a>
        </div>

      </div>
    </div>
  </div>
</div>

{% endblock %}
