{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col-md-3">
    <h5>Фильтр</h5>
    <form class="mb-3" method="get">
      <div class="mb-2"><label>Год</label><input name="year" value="{{ year }}" class="form-control"></div>
      <div class="mb-2"><label>Четверть (0=Все)</label><input name="quarter" value="{{ quarter }}" class="form-control"></div>
      <div class="mb-2">
        <label>Предмет</label>
        <select name="subject" class="form-select">
          <option value="0">Все</option>
          {% for s in subjects %}<option value="{{ s.id }}" {% if subject_id==s.id %}selected{% endif %}>{{ s.name }}</option>{% endfor %}
        </select>
      </div>
      <button class="btn btn-sm btn-primary">Показать</button>
    </form>
  </div>
  <div class="col-md-9">
    <h4>Оценки</h4>
    {% if not grades %}
      <p>Здесь пока пусто — новостная лента или информация о школе.</p>
    {% else %}
      <table class="table">
        <thead><tr><th>Предмет</th><th>Оценка</th><th>Год</th><th>Четверть</th></tr></thead>
        <tbody>
        {% for g in grades %}
          <tr>
            <td>{{ g.subject_id and (Subject.query.get(g.subject_id).name) or '' }}</td>
            <td>{{ g.value }}</td>
            <td>{{ g.year }}</td>
            <td>{{ g.quarter }}</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
      <h5>Средний балл по предметам</h5>
      <ul>
        {% for k,v in avg.items() %}<li>{{ k }}: {{ v }}</li>{% endfor %}
      </ul>
    {% endif %}
  </div>
</div>
{% endblock %}
